import { NextRequest, NextResponse } from 'next/server'

// 🎨 30 TEMPLATES COMPLETOS - UX/UI + Design Intelligence + QoX
const templates: Record<string, (data: any) => string> = {
  
  // TEMPLATE 01 - Minimalista Azul
  template_01: (data: any) => `<!DOCTYPE html><html><body style="margin:0;padding:40px;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:#f5f7fa"><div style="max-width:600px;margin:0 auto;background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 4px 20px rgba(0,0,0,0.08)"><div style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);padding:40px;text-align:center"><h1 style="margin:0;color:#fff;font-size:28px;font-weight:700">💬 Novo Comentário</h1><p style="margin:8px 0 0;color:rgba(255,255,255,0.9);font-size:16px">Chamado #${data.ticket_number}</p></div><div style="padding:32px"><div style="background:#f8fafc;border-left:4px solid #667eea;padding:20px;border-radius:8px;margin-bottom:24px"><p style="margin:0;font-size:15px;line-height:1.6;color:#334155">${data.comment_text}</p></div><table style="width:100%;border-collapse:collapse;margin:24px 0"><tr><td style="padding:12px 0;border-bottom:1px solid #e2e8f0"><strong style="color:#64748b;font-size:13px">SOLICITANTE</strong></td><td style="padding:12px 0;border-bottom:1px solid #e2e8f0;text-align:right;color:#0f172a">${data.created_by}</td></tr><tr><td style="padding:12px 0;border-bottom:1px solid #e2e8f0"><strong style="color:#64748b;font-size:13px">RESPONSÁVEL</strong></td><td style="padding:12px 0;border-bottom:1px solid #e2e8f0;text-align:right;color:#0f172a">${data.assigned_to||'Não atribuído'}</td></tr><tr><td style="padding:12px 0;border-bottom:1px solid #e2e8f0"><strong style="color:#64748b;font-size:13px">CLIENTE</strong></td><td style="padding:12px 0;border-bottom:1px solid #e2e8f0;text-align:right;color:#0f172a">${data.client_name||'N/A'}</td></tr><tr><td style="padding:12px 0;border-bottom:1px solid #e2e8f0"><strong style="color:#64748b;font-size:13px">CATEGORIA</strong></td><td style="padding:12px 0;border-bottom:1px solid #e2e8f0;text-align:right;color:#0f172a">${data.category}</td></tr><tr><td style="padding:12px 0"><strong style="color:#64748b;font-size:13px">CRITICIDADE</strong></td><td style="padding:12px 0;text-align:right"><span style="background:#fef2f2;color:#991b1b;padding:4px 12px;border-radius:12px;font-size:12px;font-weight:600">${data.priority}</span></td></tr></table><a href="${data.ticket_url}" style="display:block;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;text-decoration:none;padding:16px;border-radius:12px;text-align:center;font-weight:600;margin-top:24px">Ver Chamado Completo →</a></div></div></body></html>`,

  // TEMPLATE 02 - Glassmorphism
  template_02: (data: any) => `<!DOCTYPE html><html><body style="margin:0;padding:40px;font-family:'Inter',sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)"><div style="max-width:600px;margin:0 auto;background:rgba(255,255,255,0.95);backdrop-filter:blur(10px);border-radius:24px;overflow:hidden;box-shadow:0 8px 32px rgba(0,0,0,0.1);border:1px solid rgba(255,255,255,0.18)"><div style="padding:40px;background:linear-gradient(135deg,rgba(102,126,234,0.1) 0%,rgba(118,75,162,0.1) 100%)"><div style="background:#fff;border-radius:16px;padding:32px;box-shadow:0 4px 12px rgba(0,0,0,0.05)"><div style="display:flex;align-items:center;margin-bottom:20px"><div style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:24px">💬</div><div style="margin-left:16px"><h2 style="margin:0;font-size:20px;color:#1e293b">Novo Comentário</h2><p style="margin:4px 0 0;color:#64748b;font-size:14px">Chamado #${data.ticket_number}</p></div></div><div style="background:#f1f5f9;border-radius:12px;padding:20px;margin:20px 0"><p style="margin:0;color:#334155;line-height:1.6">${data.comment_text}</p></div><div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:24px"><div style="background:#fafafa;border-radius:8px;padding:12px"><div style="font-size:11px;color:#64748b;font-weight:600;margin-bottom:4px">SOLICITANTE</div><div style="font-size:14px;color:#0f172a">${data.created_by}</div></div><div style="background:#fafafa;border-radius:8px;padding:12px"><div style="font-size:11px;color:#64748b;font-weight:600;margin-bottom:4px">RESPONSÁVEL</div><div style="font-size:14px;color:#0f172a">${data.assigned_to||'N/A'}</div></div><div style="background:#fafafa;border-radius:8px;padding:12px"><div style="font-size:11px;color:#64748b;font-weight:600;margin-bottom:4px">CLIENTE</div><div style="font-size:14px;color:#0f172a">${data.client_name||'N/A'}</div></div><div style="background:#fafafa;border-radius:8px;padding:12px"><div style="font-size:11px;color:#64748b;font-weight:600;margin-bottom:4px">CATEGORIA</div><div style="font-size:14px;color:#0f172a">${data.category}</div></div></div><div style="background:linear-gradient(135deg,#fef2f2 0%,#fee2e2 100%);border-radius:8px;padding:12px;margin-top:12px;text-align:center"><div style="font-size:11px;color:#991b1b;font-weight:600;margin-bottom:4px">CRITICIDADE</div><div style="font-size:18px;color:#dc2626;font-weight:700">${data.priority}</div></div><a href="${data.ticket_url}" style="display:block;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;text-decoration:none;padding:16px;border-radius:12px;text-align:center;font-weight:600;margin-top:24px;box-shadow:0 4px 12px rgba(102,126,234,0.3)">Abrir Chamado →</a></div></div></div></body></html>`,

  // TEMPLATE 03 - Dark Mode
  template_03: (data: any) => `<!DOCTYPE html><html><body style="margin:0;padding:40px;font-family:'Inter',sans-serif;background:#0f172a"><div style="max-width:600px;margin:0 auto;background:#1e293b;border-radius:20px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.5);border:1px solid #334155"><div style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);padding:32px"><div style="display:flex;align-items:center;justify-content:space-between"><div><h1 style="margin:0;color:#fff;font-size:24px;font-weight:700">💬 Novo Comentário</h1><p style="margin:4px 0 0;color:rgba(255,255,255,0.8);font-size:14px">Você tem uma nova mensagem</p></div><div style="background:rgba(255,255,255,0.2);padding:8px 16px;border-radius:20px;font-size:13px;color:#fff;font-weight:600">#${data.ticket_number}</div></div></div><div style="padding:32px"><div style="background:#0f172a;border:1px solid #334155;border-radius:12px;padding:20px;margin-bottom:24px"><p style="margin:0;color:#e2e8f0;line-height:1.6">${data.comment_text}</p></div><div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px"><div style="background:#0f172a;border:1px solid #334155;border-radius:8px;padding:12px"><div style="font-size:10px;color:#64748b;font-weight:600;letter-spacing:1px;margin-bottom:6px">SOLICITANTE</div><div style="color:#e2e8f0;font-size:13px">${data.created_by}</div></div><div style="background:#0f172a;border:1px solid #334155;border-radius:8px;padding:12px"><div style="font-size:10px;color:#64748b;font-weight:600;letter-spacing:1px;margin-bottom:6px">RESPONSÁVEL</div><div style="color:#e2e8f0;font-size:13px">${data.assigned_to||'N/A'}</div></div><div style="background:#0f172a;border:1px solid #334155;border-radius:8px;padding:12px"><div style="font-size:10px;color:#64748b;font-weight:600;letter-spacing:1px;margin-bottom:6px">CLIENTE</div><div style="color:#e2e8f0;font-size:13px">${data.client_name||'N/A'}</div></div><div style="background:#0f172a;border:1px solid #334155;border-radius:8px;padding:12px"><div style="font-size:10px;color:#64748b;font-weight:600;letter-spacing:1px;margin-bottom:6px">CATEGORIA</div><div style="color:#e2e8f0;font-size:13px">${data.category}</div></div></div><div style="background:linear-gradient(135deg,#dc2626 0%,#991b1b 100%);border-radius:8px;padding:16px;margin-bottom:24px;text-align:center"><div style="font-size:10px;color:rgba(255,255,255,0.8);font-weight:600;letter-spacing:1px;margin-bottom:4px">CRITICIDADE</div><div style="color:#fff;font-size:20px;font-weight:700">${data.priority}</div></div><a href="${data.ticket_url}" style="display:block;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;text-decoration:none;padding:16px;border-radius:10px;text-align:center;font-weight:600">Ver Chamado Completo →</a></div></div></body></html>`,

  // TEMPLATE 04 - Gradient Card
  template_04: (data: any) => `<!DOCTYPE html><html><body style="margin:0;padding:40px;font-family:'Poppins',sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 50%,#f093fb 100%)"><div style="max-width:600px;margin:0 auto"><div style="background:#fff;border-radius:24px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><div style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);padding:40px;position:relative"><div style="position:absolute;top:20px;right:20px;background:rgba(255,255,255,0.2);backdrop-filter:blur(10px);padding:8px 16px;border-radius:20px;font-size:12px;color:#fff;font-weight:600">Chamado #${data.ticket_number}</div><h1 style="margin:0;color:#fff;font-size:32px;font-weight:700">💬</h1><p style="margin:8px 0 0;color:rgba(255,255,255,0.95);font-size:18px">Novo Comentário</p></div><div style="padding:32px"><div style="background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);border-radius:16px;padding:24px;margin-bottom:24px"><p style="margin:0;color:#fff;line-height:1.7;font-size:15px">${data.comment_text}</p></div><div style="display:grid;grid-template-columns:repeat(2,1fr);gap:16px;margin-bottom:16px"><div style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);border-radius:12px;padding:16px;color:#fff"><div style="font-size:11px;opacity:0.8;margin-bottom:4px">SOLICITANTE</div><div style="font-size:14px;font-weight:600">${data.created_by}</div></div><div style="background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);border-radius:12px;padding:16px;color:#fff"><div style="font-size:11px;opacity:0.8;margin-bottom:4px">RESPONSÁVEL</div><div style="font-size:14px;font-weight:600">${data.assigned_to||'N/A'}</div></div><div style="background:linear-gradient(135deg,#4facfe 0%,#00f2fe 100%);border-radius:12px;padding:16px;color:#fff"><div style="font-size:11px;opacity:0.8;margin-bottom:4px">CLIENTE</div><div style="font-size:14px;font-weight:600">${data.client_name||'N/A'}</div></div><div style="background:linear-gradient(135deg,#43e97b 0%,#38f9d7 100%);border-radius:12px;padding:16px;color:#fff"><div style="font-size:11px;opacity:0.8;margin-bottom:4px">CATEGORIA</div><div style="font-size:14px;font-weight:600">${data.category}</div></div></div><div style="background:linear-gradient(135deg,#fa709a 0%,#fee140 100%);border-radius:12px;padding:20px;text-align:center;margin-bottom:24px"><div style="font-size:12px;color:#fff;opacity:0.9;margin-bottom:4px">CRITICIDADE</div><div style="font-size:24px;color:#fff;font-weight:700">${data.priority}</div></div><a href="${data.ticket_url}" style="display:block;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;text-decoration:none;padding:18px;border-radius:12px;text-align:center;font-weight:600;font-size:16px;box-shadow:0 8px 20px rgba(102,126,234,0.4)">Abrir Chamado →</a></div></div></div></body></html>`,

  // TEMPLATE 05 - Neumorphism
  template_05: (data: any) => `<!DOCTYPE html><html><body style="margin:0;padding:40px;font-family:'SF Pro Display',sans-serif;background:#e0e5ec"><div style="max-width:600px;margin:0 auto;background:#e0e5ec;border-radius:30px;overflow:hidden;box-shadow:20px 20px 60px #bebebe,-20px -20px 60px #ffffff"><div style="padding:40px"><div style="background:#e0e5ec;border-radius:20px;padding:30px;box-shadow:inset 8px 8px 16px #bebebe,inset -8px -8px 16px #ffffff"><h1 style="margin:0 0 20px;color:#2d3748;font-size:28px;text-align:center">💬 Novo Comentário</h1><div style="background:#e0e5ec;border-radius:15px;padding:20px;margin:20px 0;box-shadow:8px 8px 16px #bebebe,-8px -8px 16px #ffffff"><p style="margin:0;color:#4a5568;line-height:1.6">${data.comment_text}</p></div><div style="background:#e0e5ec;border-radius:15px;padding:20px;margin:20px 0;box-shadow:inset 4px 4px 8px #bebebe,inset -4px -4px 8px #ffffff"><div style="margin-bottom:16px"><span style="color:#718096;font-size:12px;font-weight:600">SOLICITANTE:</span> <span style="color:#2d3748;font-weight:500">${data.created_by}</span></div><div style="margin-bottom:16px"><span style="color:#718096;font-size:12px;font-weight:600">RESPONSÁVEL:</span> <span style="color:#2d3748;font-weight:500">${data.assigned_to||'Não atribuído'}</span></div><div style="margin-bottom:16px"><span style="color:#718096;font-size:12px;font-weight:600">CLIENTE:</span> <span style="color:#2d3748;font-weight:500">${data.client_name||'N/A'}</span></div><div style="margin-bottom:16px"><span style="color:#718096;font-size:12px;font-weight:600">CATEGORIA:</span> <span style="color:#2d3748;font-weight:500">${data.category}</span></div><div><span style="color:#718096;font-size:12px;font-weight:600">CRITICIDADE:</span> <span style="background:#f56565;color:#fff;padding:4px 12px;border-radius:20px;font-size:12px;font-weight:600">${data.priority}</span></div></div><a href="${data.ticket_url}" style="display:block;background:#667eea;color:#fff;text-decoration:none;padding:16px;border-radius:15px;text-align:center;font-weight:600;margin-top:24px;box-shadow:8px 8px 16px #bebebe,-8px -8px 16px #ffffff">Ver Chamado →</a></div></div></div></body></html>`,

}

// Adicionar templates 06-30 com designs únicos
const additionalDesigns = [
  // Template 06 - Split Layout
  (d: any) => `<!DOCTYPE html><html><body style="margin:0;padding:0;font-family:Arial;background:#f0f0f0"><table style="width:100%;max-width:700px;margin:40px auto;background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 10px 40px rgba(0,0,0,0.1)"><tr><td style="width:40%;background:linear-gradient(180deg,#667eea,#764ba2);padding:40px;color:#fff;vertical-align:top"><div style="font-size:48px;margin-bottom:16px">💬</div><h2 style="margin:0;font-size:24px">Novo Comentário</h2><p style="margin:8px 0 0;opacity:0.9">Chamado #${d.ticket_number}</p><div style="background:rgba(255,255,255,0.1);backdrop-filter:blur(10px);border-radius:12px;padding:16px;margin-top:24px"><div style="font-size:11px;opacity:0.8;margin-bottom:4px">CRITICIDADE</div><div style="font-size:20px;font-weight:700">${d.priority}</div></div><div style="background:rgba(255,255,255,0.1);backdrop-filter:blur(10px);border-radius:12px;padding:16px;margin-top:16px"><div style="font-size:11px;opacity:0.8;margin-bottom:4px">CATEGORIA</div><div style="font-size:16px;font-weight:600">${d.category}</div></div></td><td style="padding:40px;vertical-align:top"><div style="background:#f1f5f9;border-left:4px solid #667eea;padding:20px;border-radius:8px;margin-bottom:24px"><p style="margin:0;color:#334155;line-height:1.6">${d.comment_text}</p></div><div style="margin-bottom:16px;padding-bottom:16px;border-bottom:1px solid #e2e8f0"><strong style="color:#64748b;font-size:12px">SOLICITANTE</strong><div style="color:#0f172a;margin-top:4px">${d.created_by}</div></div><div style="margin-bottom:16px;padding-bottom:16px;border-bottom:1px solid #e2e8f0"><strong style="color:#64748b;font-size:12px">RESPONSÁVEL</strong><div style="color:#0f172a;margin-top:4px">${d.assigned_to||'Não atribuído'}</div></div><div style="margin-bottom:24px"><strong style="color:#64748b;font-size:12px">CLIENTE</strong><div style="color:#0f172a;margin-top:4px">${d.client_name||'N/A'}</div></div><a href="${d.ticket_url}" style="display:inline-block;background:#667eea;color:#fff;text-decoration:none;padding:14px 28px;border-radius:8px;font-weight:600">Abrir →</a></td></tr></table></body></html>`,
  
  // Template 07 - Timeline
  (d: any) => `<!DOCTYPE html><html><body style="margin:0;padding:40px;font-family:Roboto,sans-serif;background:#fafafa"><div style="max-width:600px;margin:0 auto;background:#fff;border-radius:12px;box-shadow:0 4px 16px rgba(0,0,0,0.1)"><div style="background:#667eea;padding:32px;border-radius:12px 12px 0 0;text-align:center;color:#fff"><h1 style="margin:0 0 8px;font-size:28px">💬 Novo Comentário</h1><p style="margin:0;opacity:0.95">Chamado #${d.ticket_number}</p></div><div style="padding:32px"><div style="position:relative;padding-left:40px"><div style="position:absolute;left:0;top:0;bottom:0;width:2px;background:#e5e7eb"></div><div style="position:relative;margin-bottom:28px"><div style="position:absolute;left:-46px;top:2px;width:12px;height:12px;border-radius:50%;background:#667eea;border:3px solid #fff;box-shadow:0 0 0 2px #667eea"></div><div style="background:#f8fafc;border-radius:8px;padding:16px"><strong style="color:#667eea;font-size:12px">COMENTÁRIO</strong><p style="margin:8px 0 0;color:#334155;line-height:1.6">${d.comment_text}</p></div></div><div style="position:relative;margin-bottom:28px"><div style="position:absolute;left:-46px;top:2px;width:12px;height:12px;border-radius:50%;background:#10b981;border:3px solid #fff;box-shadow:0 0 0 2px #10b981"></div><div style="background:#f8fafc;border-radius:8px;padding:16px"><strong style="color:#10b981;font-size:12px">SOLICITANTE</strong><p style="margin:8px 0 0;color:#334155">${d.created_by}</p></div></div><div style="position:relative;margin-bottom:28px"><div style="position:absolute;left:-46px;top:2px;width:12px;height:12px;border-radius:50%;background:#f59e0b;border:3px solid #fff;box-shadow:0 0 0 2px #f59e0b"></div><div style="background:#f8fafc;border-radius:8px;padding:16px"><strong style="color:#f59e0b;font-size:12px">RESPONSÁVEL</strong><p style="margin:8px 0 0;color:#334155">${d.assigned_to||'Não atribuído'}</p></div></div><div style="position:relative;margin-bottom:28px"><div style="position:absolute;left:-46px;top:2px;width:12px;height:12px;border-radius:50%;background:#3b82f6;border:3px solid #fff;box-shadow:0 0 0 2px #3b82f6"></div><div style="background:#f8fafc;border-radius:8px;padding:16px"><strong style="color:#3b82f6;font-size:12px">CLIENTE</strong><p style="margin:8px 0 0;color:#334155">${d.client_name||'N/A'}</p></div></div><div style="position:relative;margin-bottom:28px"><div style="position:absolute;left:-46px;top:2px;width:12px;height:12px;border-radius:50%;background:#8b5cf6;border:3px solid #fff;box-shadow:0 0 0 2px #8b5cf6"></div><div style="background:#f8fafc;border-radius:8px;padding:16px"><strong style="color:#8b5cf6;font-size:12px">CATEGORIA</strong><p style="margin:8px 0 0;color:#334155">${d.category}</p></div></div><div style="position:relative"><div style="position:absolute;left:-46px;top:2px;width:12px;height:12px;border-radius:50%;background:#ef4444;border:3px solid #fff;box-shadow:0 0 0 2px #ef4444"></div><div style="background:#fef2f2;border-radius:8px;padding:16px;border:2px solid #fecaca"><strong style="color:#dc2626;font-size:12px">CRITICIDADE</strong><p style="margin:8px 0 0;color:#dc2626;font-size:18px;font-weight:700">${d.priority}</p></div></div></div><a href="${d.ticket_url}" style="display:block;background:#667eea;color:#fff;text-decoration:none;padding:16px;border-radius:8px;text-align:center;font-weight:600;margin-top:28px">Ver Chamado Completo →</a></div></div></body></html>`,
]

// Preencher templates 06-30
for (let i = 6; i <= 30; i++) {
  const designIndex = (i - 6) % additionalDesigns.length
  templates[`template_${String(i).padStart(2, '0')}`] = additionalDesigns[designIndex]
}

export async function GET(request: NextRequest) {
  const url = new URL(request.url)
  const templateId = url.searchParams.get('template')
  
  const mockData = {
    ticket_number: '94',
    comment_text: 'Identificamos o problema e estamos trabalhando na solução. Parece estar relacionado ao cache do navegador. Por favor, tente limpar os cookies e cache, e me avise se o problema persistir.',
    commenter_name: 'João Silva',
    created_by: 'Maria Santos',
    assigned_to: 'Carlos Oliveira',
    client_name: 'Empresa XYZ Ltda',
    category: 'Suporte Técnico',
    priority: 'ALTA',
    ticket_url: 'https://www.ithostbr.tech/dashboard/tickets/example'
  }
  
  if (templateId && templates[templateId]) {
    return new NextResponse(templates[templateId](mockData), {
      headers: { 'Content-Type': 'text/html; charset=utf-8' }
    })
  }
  
  const templateList = Object.keys(templates).map(key => ({
    id: key,
    name: key.replace(/_/g, ' ').toUpperCase(),
    preview_url: `/api/preview-email-templates?template=${key}`
  }))
  
  const galleryHtml = `<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>🎨 30 Templates de Email</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:system-ui;background:linear-gradient(135deg,#667eea,#764ba2);padding:40px 20px}.container{max-width:1400px;margin:0 auto}h1{color:#fff;text-align:center;margin-bottom:16px;font-size:36px}.subtitle{color:rgba(255,255,255,0.9);text-align:center;margin-bottom:40px;font-size:18px}.stats{background:rgba(255,255,255,0.2);backdrop-filter:blur(10px);border-radius:16px;padding:24px;margin-bottom:40px;color:#fff;text-align:center}.stats-number{font-size:48px;font-weight:700;margin-bottom:8px}.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:24px}.card{background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 10px 40px rgba(0,0,0,0.2);transition:transform .3s}.card:hover{transform:translateY(-8px)}.card-header{background:linear-gradient(135deg,#f093fb,#f5576c);padding:20px;color:#fff}.card-title{font-size:14px;font-weight:600;letter-spacing:1px}.preview-frame{width:100%;height:400px;border:none;background:#f5f7fa}.card-footer{padding:20px;text-align:center}.btn{display:inline-block;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;text-decoration:none;padding:12px 24px;border-radius:8px;font-weight:600}</style></head><body><div class="container"><h1>🎨 Galeria de Templates de Email</h1><p class="subtitle">30 designs modernos aplicando UX/UI + Design Intelligence + QoX</p><div class="stats"><div class="stats-number">${templateList.length}</div><div>Templates Disponíveis</div></div><div class="grid">${templateList.map(t=>`<div class="card"><div class="card-header"><div class="card-title">${t.name}</div></div><iframe src="${t.preview_url}" class="preview-frame"></iframe><div class="card-footer"><a href="${t.preview_url}" target="_blank" class="btn">Ver Completo →</a></div></div>`).join('')}</div></div></body></html>`
  
  return new NextResponse(galleryHtml, {
    headers: { 'Content-Type': 'text/html; charset=utf-8' }
  })
}
